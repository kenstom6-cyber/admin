<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Remote Key Manager</title>
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
</head>
<body>
    <div class="container">
        <!-- Sidebar -->
        <div class="sidebar">
            <div class="logo">
                <i class="fas fa-key"></i>
                <h2>Key Manager</h2>
            </div>
            
            <div class="menu">
                <div class="menu-item active" onclick="showSection('dashboard')">
                    <i class="fas fa-tachometer-alt"></i>
                    <span>Dashboard</span>
                </div>
                <div class="menu-item" onclick="showSection('create-keys')">
                    <i class="fas fa-plus-circle"></i>
                    <span>T·∫°o Key</span>
                </div>
                <div class="menu-item" onclick="showSection('manage-keys')">
                    <i class="fas fa-list"></i>
                    <span>Qu·∫£n l√Ω Key</span>
                </div>
                <div class="menu-item" onclick="showSection('validate-key')">
                    <i class="fas fa-check-circle"></i>
                    <span>Ki·ªÉm tra Key</span>
                </div>
                <div class="menu-item" onclick="showSection('server-config')">
                    <i class="fas fa-server"></i>
                    <span>C·∫•u h√¨nh Server</span>
                </div>
                <div class="menu-item" onclick="showSection('api-docs')">
                    <i class="fas fa-code"></i>
                    <span>API & Shell</span>
                </div>
            </div>
            
            <div class="server-status">
                <div class="status-indicator" id="serverStatus">
                    <div class="dot"></div>
                    <span>ƒêang k·∫øt n·ªëi...</span>
                </div>
            </div>
        </div>

        <!-- Main Content -->
        <div class="main-content">
            <!-- Header -->
            <div class="header">
                <h1 id="pageTitle">Dashboard</h1>
                <div class="header-actions">
                    <div class="server-key-input">
                        <input type="password" id="serverKey" placeholder="Nh·∫≠p Server Key...">
                        <button class="btn-connect" onclick="connectServer()">
                            <i class="fas fa-plug"></i> K·∫øt n·ªëi
                        </button>
                    </div>
                    <button class="btn-notification">
                        <i class="fas fa-bell"></i>
                        <span class="badge" id="notificationCount">0</span>
                    </button>
                </div>
            </div>

            <!-- Dashboard Section -->
            <div class="content-section active" id="dashboard-section">
                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-icon">
                            <i class="fas fa-key"></i>
                        </div>
                        <div class="stat-info">
                            <h3>T·ªïng s·ªë Key</h3>
                            <p id="totalKeys">0</p>
                        </div>
                    </div>
                    
                    <div class="stat-card">
                        <div class="stat-icon active">
                            <i class="fas fa-check-circle"></i>
                        </div>
                        <div class="stat-info">
                            <h3>ƒêang ho·∫°t ƒë·ªông</h3>
                            <p id="activeKeys">0</p>
                        </div>
                    </div>
                    
                    <div class="stat-card">
                        <div class="stat-icon locked">
                            <i class="fas fa-lock"></i>
                        </div>
                        <div class="stat-info">
                            <h3>ƒê√£ kh√≥a</h3>
                            <p id="lockedKeys">0</p>
                        </div>
                    </div>
                    
                    <div class="stat-card">
                        <div class="stat-icon suspended">
                            <i class="fas fa-pause-circle"></i>
                        </div>
                        <div class="stat-info">
                            <h3>T·∫°m ng∆∞ng</h3>
                            <p id="suspendedKeys">0</p>
                        </div>
                    </div>
                </div>

                <div class="quick-actions">
                    <h3>Thao t√°c nhanh</h3>
                    <div class="actions-grid">
                        <button class="action-btn" onclick="showSection('create-keys')">
                            <i class="fas fa-plus"></i>
                            <span>T·∫°o Key m·ªõi</span>
                        </button>
                        <button class="action-btn" onclick="showSection('server-config')">
                            <i class="fas fa-cog"></i>
                            <span>C·∫•u h√¨nh Server</span>
                        </button>
                        <button class="action-btn" onclick="generateServerKey()">
                            <i class="fas fa-key"></i>
                            <span>T·∫°o Server Key</span>
                        </button>
                        <button class="action-btn" onclick="showSection('api-docs')">
                            <i class="fas fa-terminal"></i>
                            <span>Shell Script</span>
                        </button>
                    </div>
                </div>

                <div class="recent-activity">
                    <h3>Ho·∫°t ƒë·ªông g·∫ßn ƒë√¢y</h3>
                    <div class="activity-list" id="activityList">
                        <!-- Activity items will be loaded here -->
                    </div>
                </div>
            </div>

            <!-- Create Keys Section -->
            <div class="content-section" id="create-keys-section">
                <div class="section-header">
                    <h2><i class="fas fa-plus-circle"></i> T·∫°o Key M·ªõi</h2>
                    <p>T·∫°o h√†ng lo·∫°t key v·ªõi c·∫•u h√¨nh t√πy ch·ªânh</p>
                </div>
                
                <div class="create-form">
                    <div class="form-row">
                        <div class="form-group">
                            <label>S·ªë l∆∞·ª£ng key</label>
                            <input type="number" id="keyCount" min="1" max="1000" value="1">
                            <small>T·ªëi ƒëa 1000 key m·ªói l·∫ßn t·∫°o</small>
                        </div>
                        
                        <div class="form-group">
                            <label>ƒê·ªô d√†i key</label>
                            <select id="keyLength">
                                <option value="8">8 k√Ω t·ª±</option>
                                <option value="16" selected>16 k√Ω t·ª±</option>
                                <option value="24">24 k√Ω t·ª±</option>
                                <option value="32">32 k√Ω t·ª±</option>
                            </select>
                        </div>
                    </div>
                    
                    <div class="form-row">
                        <div class="form-group">
                            <label>Th·ªùi h·∫°n (ng√†y)</label>
                            <input type="number" id="keyDuration" min="1" max="365" value="30">
                            <small>T·ª´ 1 ƒë·∫øn 365 ng√†y</small>
                        </div>
                        
                        <div class="form-group">
                            <label>Prefix (t√πy ch·ªçn)</label>
                            <input type="text" id="keyPrefix" placeholder="VD: API_, USER_">
                        </div>
                    </div>
                    
                    <div class="form-group full-width">
                        <label>Ghi ch√∫</label>
                        <textarea id="keyNote" placeholder="M√¥ t·∫£ ho·∫∑c ghi ch√∫ cho key..."></textarea>
                    </div>
                    
                    <div class="form-actions">
                        <button class="btn-primary" onclick="createKeys()">
                            <i class="fas fa-magic"></i> T·∫°o Key
                        </button>
                        <button class="btn-secondary" onclick="resetCreateForm()">
                            <i class="fas fa-redo"></i> ƒê·∫∑t l·∫°i
                        </button>
                    </div>
                </div>
                
                <div class="preview-section" id="keyPreview" style="display: none;">
                    <h3>Key v·ª´a t·∫°o</h3>
                    <div class="preview-box" id="previewContent"></div>
                    <button class="btn-copy" onclick="copyCreatedKeys()">
                        <i class="fas fa-copy"></i> Sao ch√©p t·∫•t c·∫£
                    </button>
                </div>
            </div>

            <!-- Manage Keys Section -->
            <div class="content-section" id="manage-keys-section">
                <div class="section-header">
                    <h2><i class="fas fa-list"></i> Qu·∫£n l√Ω Key</h2>
                    <p>T√¨m ki·∫øm, l·ªçc v√† qu·∫£n l√Ω t·∫•t c·∫£ key</p>
                </div>
                
                <div class="filter-bar">
                    <div class="search-box">
                        <i class="fas fa-search"></i>
                        <input type="text" id="searchKey" placeholder="T√¨m ki·∫øm theo key, ghi ch√∫...">
                    </div>
                    
                    <div class="filter-options">
                        <select id="filterStatus">
                            <option value="all">T·∫•t c·∫£ tr·∫°ng th√°i</option>
                            <option value="active">ƒêang ho·∫°t ƒë·ªông</option>
                            <option value="locked">ƒê√£ kh√≥a</option>
                            <option value="suspended">T·∫°m ng∆∞ng</option>
                        </select>
                        
                        <select id="sortBy">
                            <option value="created">M·ªõi nh·∫•t</option>
                            <option value="expires">S·∫Øp h·∫øt h·∫°n</option>
                            <option value="key">A-Z</option>
                        </select>
                    </div>
                </div>
                
                <div class="table-responsive">
                    <table id="keysTable">
                        <thead>
                            <tr>
                                <th>Key</th>
                                <th>Tr·∫°ng th√°i</th>
                                <th>Ng√†y t·∫°o</th>
                                <th>H·∫øt h·∫°n</th>
                                <th>L·∫ßn d√πng cu·ªëi</th>
                                <th>Thao t√°c</th>
                            </tr>
                        </thead>
                        <tbody id="keysBody">
                            <!-- Keys will be loaded here -->
                        </tbody>
                    </table>
                </div>
                
                <div class="table-footer">
                    <div class="pagination">
                        <button class="btn-pagination" onclick="prevPage()">
                            <i class="fas fa-chevron-left"></i>
                        </button>
                        <span id="pageInfo">Trang 1 c·ªßa 1</span>
                        <button class="btn-pagination" onclick="nextPage()">
                            <i class="fas fa-chevron-right"></i>
                        </button>
                    </div>
                    <div class="table-stats">
                        Hi·ªÉn th·ªã <span id="showingCount">0</span> trong t·ªïng s·ªë <span id="totalCount">0</span> key
                    </div>
                </div>
            </div>

            <!-- Validate Key Section -->
            <div class="content-section" id="validate-key-section">
                <div class="section-header">
                    <h2><i class="fas fa-check-circle"></i> Ki·ªÉm tra Key</h2>
                    <p>Ki·ªÉm tra t√≠nh h·ª£p l·ªá c·ªßa key t·ª´ xa</p>
                </div>
                
                <div class="validator-card">
                    <div class="validator-input">
                        <input type="text" id="validateKey" placeholder="Nh·∫≠p key c·∫ßn ki·ªÉm tra...">
                        <button class="btn-validate" onclick="validateKey()">
                            <i class="fas fa-search"></i> Ki·ªÉm tra
                        </button>
                    </div>
                    
                    <div class="validator-result" id="validationResult" style="display: none;">
                        <!-- Result will be shown here -->
                    </div>
                    
                    <div class="validator-examples">
                        <h4>V√≠ d·ª• cho Shell Script:</h4>
                        <pre><code>curl -X POST https://your-domain.com/api/validate \
  -H "Content-Type: application/json" \
  -d '{"key": "YOUR_KEY_HERE"}'</code></pre>
                    </div>
                </div>
            </div>

            <!-- Server Config Section -->
            <div class="content-section" id="server-config-section">
                <div class="section-header">
                    <h2><i class="fas fa-server"></i> C·∫•u h√¨nh Server</h2>
                    <p>Qu·∫£n l√Ω Server Key v√† c√†i ƒë·∫∑t h·ªá th·ªëng</p>
                </div>
                
                <div class="config-cards">
                    <div class="config-card">
                        <h3><i class="fas fa-key"></i> Server Key</h3>
                        <div class="config-content">
                            <div class="current-key">
                                <label>Server Key hi·ªán t·∫°i:</label>
                                <div class="key-display" id="currentKeyDisplay">
                                    <span>‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢</span>
                                    <button class="btn-show" onclick="toggleKeyVisibility()">
                                        <i class="fas fa-eye"></i>
                                    </button>
                                </div>
                            </div>
                            
                            <div class="config-form">
                                <h4>T·∫°o Server Key m·ªõi</h4>
                                <input type="password" id="newServerKey" placeholder="Nh·∫≠p Server Key m·ªõi...">
                                <input type="password" id="confirmServerKey" placeholder="X√°c nh·∫≠n Server Key...">
                                <button class="btn-danger" onclick="changeServerKey()">
                                    <i class="fas fa-sync-alt"></i> ƒê·ªïi Server Key
                                </button>
                            </div>
                        </div>
                    </div>
                    
                    <div class="config-card">
                        <h3><i class="fas fa-cog"></i> C√†i ƒë·∫∑t h·ªá th·ªëng</h3>
                        <div class="config-content">
                            <div class="setting-item">
                                <label>S·ªë key t·ªëi ƒëa</label>
                                <input type="number" id="maxKeys" min="100" max="10000" value="1000">
                            </div>
                            
                            <div class="setting-item">
                                <label>Key m·∫∑c ƒë·ªãnh h·∫øt h·∫°n (ng√†y)</label>
                                <input type="number" id="defaultExpiry" min="1" max="365" value="30">
                            </div>
                            
                            <div class="setting-item">
                                <label>T·ª± ƒë·ªông d·ªçn d·∫πp key h·∫øt h·∫°n</label>
                                <label class="switch">
                                    <input type="checkbox" id="autoCleanup" checked>
                                    <span class="slider"></span>
                                </label>
                            </div>
                            
                            <button class="btn-primary" onclick="saveSettings()">
                                <i class="fas fa-save"></i> L∆∞u c√†i ƒë·∫∑t
                            </button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- API & Shell Section -->
            <div class="content-section" id="api-docs-section">
                <div class="section-header">
                    <h2><i class="fas fa-code"></i> API & Shell Script</h2>
                    <p>T√†i li·ªáu API v√† v√≠ d·ª• Shell Script</p>
                </div>
                
                <div class="api-docs">
                    <div class="api-endpoint">
                        <h3><i class="fas fa-exchange-alt"></i> Ki·ªÉm tra Key (Shell)</h3>
                        <pre><code class="language-bash">#!/bin/bash

KEY="YOUR_KEY_HERE"
SERVER_URL="https://your-domain.com"

RESPONSE=$(curl -s -X POST "$SERVER_URL/api/validate" \
  -H "Content-Type: application/json" \
  -d "{\"key\": \"$KEY\"}")

VALID=$(echo $RESPONSE | grep -o '"valid":true')
if [ ! -z "$VALID" ]; then
    echo "‚úÖ Key h·ª£p l·ªá"
    EXPIRES=$(echo $RESPONSE | grep -o '"expiresAt":"[^"]*"' | cut -d'"' -f4)
    echo "üìÖ H·∫øt h·∫°n: $EXPIRES"
else
    echo "‚ùå Key kh√¥ng h·ª£p l·ªá"
    MSG=$(echo $RESPONSE | grep -o '"message":"[^"]*"' | cut -d'"' -f4)
    echo "üìù L√Ω do: $MSG"
fi</code></pre>
                    </div>
                    
                    <div class="api-endpoint">
                        <h3><i class="fas fa-list"></i> L·∫•y danh s√°ch Key</h3>
                        <pre><code class="language-bash">#!/bin/bash

SERVER_KEY="YOUR_SERVER_KEY"
SERVER_URL="https://your-domain.com"

curl -X GET "$SERVER_URL/api/keys" \
  -H "X-Server-Key: $SERVER_KEY" \
  -H "Content-Type: application/json"</code></pre>
                    </div>
                    
                    <div class="api-endpoint">
                        <h3><i class="fas fa-plus"></i> T·∫°o Key t·ª´ Shell</h3>
                        <pre><code class="language-bash">#!/bin/bash

SERVER_KEY="YOUR_SERVER_KEY"
SERVER_URL="https://your-domain.com"
COUNT=5
DAYS=30
NOTE="Created from shell script"

curl -X POST "$SERVER_URL/api/keys/create" \
  -H "X-Server-Key: $SERVER_KEY" \
  -H "Content-Type: application/json" \
  -d "{
    \"count\": $COUNT,
    \"duration\": $DAYS,
    \"note\": \"$NOTE\"
  }"</code></pre>
                    </div>
                    
                    <div class="api-endpoint">
                        <h3><i class="fas fa-lock"></i> Kh√≥a/M·ªü kh√≥a Key</h3>
                        <pre><code class="language-bash">#!/bin/bash

SERVER_KEY="YOUR_SERVER_KEY"
SERVER_URL="https://your-domain.com"
KEY_ID="KEY_ID_HERE"
ACTION="locked"  # ho·∫∑c "active", "suspended"

curl -X PUT "$SERVER_URL/api/keys/$KEY_ID/status" \
  -H "X-Server-Key: $SERVER_KEY" \
  -H "Content-Type: application/json" \
  -d "{\"status\": \"$ACTION\"}"</code></pre>
                    </div>
                    
                    <div class="api-download">
                        <h3><i class="fas fa-download"></i> T·∫£i Shell Script m·∫´u</h3>
                        <p>T·∫£i v·ªÅ c√°c script m·∫´u ƒë√£ c·∫•u h√¨nh s·∫µn:</p>
                        <div class="download-buttons">
                            <button class="btn-primary" onclick="downloadScript('validate.sh')">
                                <i class="fas fa-download"></i> validate.sh
                            </button>
                            <button class="btn-primary" onclick="downloadScript('create_keys.sh')">
                                <i class="fas fa-download"></i> create_keys.sh
                            </button>
                            <button class="btn-primary" onclick="downloadScript('manage_keys.sh')">
                                <i class="fas fa-download"></i> manage_keys.sh
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal -->
    <div id="keyDetailModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Chi ti·∫øt Key</h3>
                <button class="btn-close" onclick="closeModal()">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body" id="keyDetails"></div>
        </div>
    </div>

    <script src="script.js"></script>
    <script>
        // Syntax highlighting
        document.querySelectorAll('pre code').forEach((block) => {
            block.classList.add('language-bash');
        });
    </script>
</body>
</html>
